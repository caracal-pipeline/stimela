_include:
  - (cultcargo)breizorro.yml

opts:
  log:
    dir: test-logs/logs-{config.run.datetime}
    nest: 3
    symlink: logs
  backend:
    select: kube
    kube:
      dir: /mnt/data/stimela-test
      namespace: rarg-test-compute
      volumes:
        rarg-test-compute-pvc: /mnt/data
      ## default pod spec
      pod_spec:
        nodeSelector:
          rarg/node-class: compute
          rarg/instance-type: m5.large
      ## override user/group ID
      uid: 1669
      gid: 1669
      ## you can specify a global memory default for pods here,
      ## otherwise go on a per-cab or per-step basis
      # memory: 64Gi


# cabs:
#   breizorro:     # ask for more RAM for breizorro pod
#     backend:
#       kube:
#         memory: 1Gi

recipe:
  name: "demo recipe"
  info: 'top level recipe definition'
  steps:
      test_breizorro:
        cab: breizorro
        params:
          restored-image: im3-MFS-image.fits
          mask: =STRIPEXT(current.restored-image) + ".mask.fits"
